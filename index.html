<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!--移动端设置meta:vp-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/base.css">
  <link rel="stylesheet" href="./css/index.css">
  <script src="./js/index.js"></script>
  <script src="./js/zepto-master/src/zepto.min.js"></script>
  <script src="./js/zepto-master/src/selector.js"></script>
  <script src="./js/zepto-master/src/fx.js"></script>
  <script src="./js/zepto-master/src/touch.js"></script>
  <title>Title</title>
</head>
<body>
<div class="jd_layout">
  <!--搜索块-->
  <div class="jd_search">
    <a href="javascript:;" class="jd_logo"></a>
    <form action="" class="jd_searchBox">
      <input type="text" placeholder="请输入商品名称">
    </form>
    <a href="javascript:;" class="jd_login">登录</a>
  </div>
  <!--轮播图-->
  <div class="jd_banner">
    <ul class="jd_bannerImg">
      <li>
        <a href="javascript:;">
          <img src="./uploads/l1.jpg" alt="">
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./uploads/l2.jpg" alt="">
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./uploads/l3.jpg" alt="">
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./uploads/l4.jpg" alt="">
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./uploads/l5.jpg" alt="">
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./uploads/l6.jpg" alt="">
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./uploads/l7.jpg" alt="">
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./uploads/l8.jpg" alt="">
        </a>
      </li>
      
    </ul>
    <!--点标记-->
    <ul class="jd_bannerIndicator">
      <li class="active"></li>
      <li></li>
      <li></li>
      <li></li>
      <li></li>
      <li></li>
      <li></li>
      <li></li>
    </ul>
  </div>
  <!--导航栏-->
  <div class="jd_nav">
    <ul class="clearfix">
      <li>
        <a href="javascript:;">
          <img src="./images/nav0.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./images/nav1.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./images/nav2.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./images/nav3.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./images/nav4.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./images/nav5.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./images/nav6.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <img src="./images/nav7.png" alt="">
          <p>商品分类</p>
        </a>
      </li>
    </ul>
  </div>
  <!--产品块-->
  <div class="jd_products">
    <div class="jd_productBox clearfix jd_sk">
      <div class="jd_pTips">
        <div class="jd_left f_left">
          <span class="jd_sk_icon f_left m_left"></span>
          <span class="jd_sk_text f_left m_left">京东秒杀</span>
          <div class="jd_sk_time f_left m_left">
            <span>0</span>
            <span>0</span>
            <span>:</span>
            <span>0</span>
            <span>0</span>
            <span>:</span>
            <span>0</span>
            <span>0</span>
          </div>
        </div>
        <div class="jd_right f_right">更多秒杀</div>
      </div>
      <div class="jd_pProduct clearfix">
        <ul>
          <li>
            <a href="javascript:;">
              <img src="./images/detail01.jpg" alt="">
            </a>
            <p>&yen;10.00</p>
          </li>
          <li>
            <a href="javascript:;">
              <img src="./images/detail01.jpg" alt="">
            </a>
            <p>&yen;10.00</p>
          </li>
          <li>
            <a href="javascript:;">
              <img src="./images/detail01.jpg" alt="">
            </a>
            <p>&yen;10.00</p>
          </li>
        </ul>
      </div>

    </div>

    <div class="jd_productBox">
      <div class="jd_pTips">
        <h3>京东超市</h3>
      </div>
      <div class="jd_pProduct clearfix">
        <a href="javascript:;" class="a_50 f_left">
          <img src="./uploads/cp1.jpg" alt="">
        </a>
        <a href="javascript:;" class="a_50 f_left b_left b_bottom">
          <img src="./uploads/cp2.jpg" alt="">
        </a>
        <a href="javascript:;" class="a_50 f_left b_left">
          <img src="./uploads/cp3.jpg" alt="">
        </a>
      </div>
    </div>
    <div class="jd_productBox">
      <div class="jd_pTips">
        <h3>京东超市</h3>
      </div>
      <div class="jd_pProduct clearfix">
        <a href="javascript:;" class="a_50 f_left">
          <img src="./uploads/cp4.jpg" alt="">
        </a>
        <a href="javascript:;" class="a_50 f_left b_left b_bottom">
          <img src="./uploads/cp5.jpg" alt="">
        </a>
        <a href="javascript:;" class="a_50 f_left b_left">
          <img src="./uploads/cp6.jpg" alt="">
        </a>
      </div>
    </div>
    <div class="jd_productBox">
      <div class="jd_pTips">
        <h3>京东超市</h3>
      </div>
      <div class="jd_pProduct clearfix">
        <a href="javascript:;" class="a_50 f_left">
          <img src="./uploads/cp1.jpg" alt="">
        </a>
        <a href="javascript:;" class="a_50 f_left b_left b_bottom">
          <img src="./uploads/cp2.jpg" alt="">
        </a>
        <a href="javascript:;" class="a_50 f_left b_left">
          <img src="./uploads/cp3.jpg" alt="">
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  // 使用zepto实现轮播图
  /*
  * 1.添加首尾两张图片
  * 2.重新设置图片盒子和宽度和图片的宽度
  * 3.开启定时器,实现自动轮播
  * 4.添加移动端的滑动事件,实现手动轮播
  * 5.添加过渡效果结束之后的监听
  * */
  $(function () {
    // 获取轮播图元素
    var banner = $(".jd_banner");
    var bannerWidth = banner.width();
    // 获取图片盒子
    var imgBox = banner.find("ul:first-of-type");
    // console.log(imgBox);
    // 获取点标记, 使用eq选择需要引入selector.js
    var indicators = banner.find("ul:eq(1)").find("li");
    // console.log(indicators);
    // 获取首尾两张元素
    var first = imgBox.find("li:first-of-type");
    var last = imgBox.find("li:last-of-type");
    // 添加首尾位置
    imgBox.append(first.clone());
    last.clone().insertBefore(first);
    // 设置图片盒子的宽度
    var lis = imgBox.find("li");
    var count = lis.length;
    imgBox.width(count*bannerWidth);
    // 设置li标签的宽度
    lis.each(function (index, value) {
      $(lis[index]).width(bannerWidth)
    });
    // 设置默认偏移,使第一张图归位
    imgBox.css("left", -bannerWidth);

    // 定义图片索引
    var index = 1;

    // 封装图片轮播的动画效果
    var imgAnimation = function () {
      imgBox.animate(
        {"left":-index*bannerWidth},
        800,
        "ease-in-out",
        function () {// 动画执行完毕的回调函数
          //判断当前索引是否是最后一张或第一张
          if (index==count-1) { // 最后一张
            index=1;
            /*让他瞬间偏移到索引1的位置---非过渡*/
            imgBox.css("left",-index*bannerWidth);
          }
          else if(index==0){
            index=count-2;
            imgBox.css("left",-index*bannerWidth);
          }
          // 设置点标记
          indicators.removeClass("active").eq(index-1).addClass("active");
        }
      );
    };
    // 开启定时器
    var timeId;
    var startTime = function(){
      timeId= setInterval(function () {
        index++;
        // 开启过渡,设置定位
        // 在zepto中直接使用animate函数实现3和5
        // 使用animate函数需要引入fx.js
        imgAnimation();

      }, 2000);
    };
    startTime();

    /*添加滑动事件, 在touch模块中
    * 在谷歌浏览器模拟器中无法触发swipe相关事件, 但是可以触发tap事件
    * 傲游浏览器ok...
    * */

    imgBox.on("swipeLeft", function () {
      clearInterval(timeId);
      index++;
      // console.log("swipeLeft");
      imgAnimation();
      startTime();
    });
    imgBox.on("swipeRight", function () {
      clearInterval(timeId);
      index--;
      // console.log("swipeRight");
      imgAnimation();
      startTime();
    })
  })


</script>
</body>
</html>